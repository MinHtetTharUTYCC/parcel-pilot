{"openapi":"3.0.0","paths":{"/health":{"get":{"description":"Check if the API server is running and healthy.","operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":"Server is healthy and running","content":{"application/json":{"schema":{"example":"Hello Parcels!"}}}}},"summary":"Health Check","tags":["health"]}},"/parcels":{"get":{"description":"Retrieve a list of all parcels in the system with optional search and pagination. Only STAFF and MANAGER roles can access this.","operationId":"ParcelsController_getAllParcels","parameters":[{"name":"cursor","required":false,"in":"query","description":"Cursor for pagination - retrieve records after this cursor","schema":{"example":"cursor_string_here","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Number of records to retrieve per page","schema":{"default":10,"example":10,"type":"number"}},{"name":"q","required":false,"in":"query","description":"Search query for filtering parcels by order ID, recipient name, or description","schema":{"example":"John","type":"string"}},{"description":"Cursor for pagination - retrieve records after this cursor","required":false,"name":"cursor","in":"query","schema":{"example":"cursor_string_here","type":"string"}},{"description":"Number of records to retrieve per page","required":false,"name":"limit","in":"query","schema":{"default":10,"example":10,"type":"number"}},{"description":"Search query for filtering parcels by order ID, recipient name, or description","required":false,"name":"q","in":"query","schema":{"example":"John","type":"string"}}],"responses":{"200":{"description":"List of parcels retrieved successfully","content":{"application/json":{"schema":{"example":{"data":[{"id":"parcel-id-1","orderId":"ORD-2026-001","recipientId":"resident-id-1","recipient":{"id":"resident-id-1","name":"John Doe","email":"john@example.com","unitNumber":"A-101"},"description":"Package contents","status":"PENDING","courier":"DHL","createdAt":"2026-01-15T10:30:00Z"}],"meta":{"total":50,"limit":10,"cursor":"next_cursor"}}}}}},"403":{"description":"Forbidden - insufficient permissions"}},"security":[{"access-token":[]}],"summary":"Get All Parcels","tags":["Parcels"]},"post":{"description":"Create a new parcel entry in the system. Only STAFF and MANAGER roles can create parcels.","operationId":"ParcelsController_createParcel","parameters":[],"requestBody":{"required":true,"description":"Parcel creation details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateParcelDto"}}}},"responses":{"201":{"description":"Parcel created successfully","content":{"application/json":{"schema":{"example":{"id":"parcel-id-new","orderId":"ORD-2026-002","recipientId":"resident-id-1","description":"New package","status":"PENDING","courier":"FedEx","createdAt":"2026-01-15T11:45:00Z"}}}}},"400":{"description":"Validation error - invalid input"},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Recipient not found"}},"security":[{"access-token":[]}],"summary":"Create New Parcel","tags":["Parcels"]}},"/parcels/mine":{"get":{"description":"Retrieve parcels for the logged-in resident. Only RESIDENT role can access this.","operationId":"ParcelsController_getMyParcels","parameters":[{"name":"cursor","required":false,"in":"query","description":"Cursor for pagination - retrieve records after this cursor","schema":{"example":"cursor_string_here","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Number of records to retrieve per page","schema":{"default":10,"example":10,"type":"number"}},{"name":"q","required":false,"in":"query","description":"Search query for filtering parcels by order ID, recipient name, or description","schema":{"example":"John","type":"string"}},{"description":"Cursor for pagination - retrieve records after this cursor","required":false,"name":"cursor","in":"query","schema":{"example":"cursor_string_here","type":"string"}},{"description":"Number of records to retrieve per page","required":false,"name":"limit","in":"query","schema":{"default":10,"example":10,"type":"number"}},{"description":"Search query for filtering parcels by order ID, recipient name, or description","required":false,"name":"q","in":"query","schema":{"example":"John","type":"string"}}],"responses":{"200":{"description":"List of resident parcels retrieved successfully","content":{"application/json":{"schema":{"example":{"data":[{"id":"parcel-id-1","orderId":"ORD-2026-001","recipientId":"resident-id-1","description":"Package contents","status":"PENDING","courier":"DHL","createdAt":"2026-01-15T10:30:00Z"}],"meta":{"total":5,"limit":10,"cursor":null}}}}}},"403":{"description":"Forbidden - insufficient permissions"}},"security":[{"access-token":[]}],"summary":"Get My Parcels","tags":["Parcels"]}},"/parcels/{id}":{"get":{"description":"Retrieve detailed information about a specific parcel. Residents can only view their own parcels.","operationId":"ParcelsController_getParcel","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the parcel","schema":{"example":"parcel-id-123","type":"string"}}],"responses":{"200":{"description":"Parcel details retrieved successfully","content":{"application/json":{"schema":{"example":{"id":"parcel-id-1","orderId":"ORD-2026-001","recipientId":"resident-id-1","recipient":{"id":"resident-id-1","name":"John Doe","email":"john@example.com","unitNumber":"A-101","phone":"+1234567890"},"description":"Package contents","note":"Handle with care","imageUrl":"https://example.com/image.jpg","status":"PENDING","courier":"DHL","createdAt":"2026-01-15T10:30:00Z","pickedUpAt":null,"returnedAt":null}}}}},"403":{"description":"Forbidden - cannot view other residents parcels"},"404":{"description":"Parcel not found"}},"security":[{"access-token":[]}],"summary":"Get Parcel Details","tags":["Parcels"]},"patch":{"description":"Update parcel information. Only STAFF and MANAGER roles can update parcels.","operationId":"ParcelsController_updateParcel","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the parcel","schema":{"example":"parcel-id-123","type":"string"}}],"requestBody":{"required":true,"description":"Parcel fields to update (all fields optional)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateParcelDto"}}}},"responses":{"200":{"description":"Parcel updated successfully","content":{"application/json":{"schema":{"example":{"id":"parcel-id-1","orderId":"ORD-2026-001-UPDATED","description":"Updated description","note":"Updated notes","courier":"DHL","updatedAt":"2026-01-15T13:00:00Z"}}}}},"400":{"description":"Validation error - invalid input"},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Parcel not found"}},"security":[{"access-token":[]}],"summary":"Update Parcel","tags":["Parcels"]},"delete":{"description":"Delete a parcel record from the system. Only STAFF and MANAGER roles can delete parcels.","operationId":"ParcelsController_deleteParcel","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the parcel","schema":{"example":"parcel-id-123","type":"string"}}],"responses":{"200":{"description":"Parcel deleted successfully","content":{"application/json":{"schema":{"example":{"success":true,"message":"Parcel deleted successfully","id":"parcel-id-1"}}}}},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Parcel not found"}},"security":[{"access-token":[]}],"summary":"Delete Parcel","tags":["Parcels"]}},"/parcels/pickup/{id}":{"patch":{"description":"Update parcel status to picked up by the resident. Only STAFF and MANAGER roles can perform this action.","operationId":"ParcelsController_pickupParcel","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the parcel","schema":{"example":"parcel-id-123","type":"string"}}],"responses":{"200":{"description":"Parcel marked as picked up successfully","content":{"application/json":{"schema":{"example":{"id":"parcel-id-1","status":"PICKED_UP","pickedUpAt":"2026-01-15T12:00:00Z"}}}}},"400":{"description":"Parcel cannot be picked up - invalid status"},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Parcel not found"}},"security":[{"access-token":[]}],"summary":"Mark Parcel as Picked Up","tags":["Parcels"]}},"/parcels/return/{id}":{"patch":{"description":"Update parcel status to returned to sender. Only STAFF and MANAGER roles can perform this action.","operationId":"ParcelsController_returnParcel","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the parcel","schema":{"example":"parcel-id-123","type":"string"}}],"responses":{"200":{"description":"Parcel marked as returned successfully","content":{"application/json":{"schema":{"example":{"id":"parcel-id-1","status":"RETURNED","returnedAt":"2026-01-15T12:30:00Z"}}}}},"400":{"description":"Parcel cannot be returned - invalid status"},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Parcel not found"}},"security":[{"access-token":[]}],"summary":"Mark Parcel as Returned","tags":["Parcels"]}},"/auth/login":{"post":{"description":"Authenticate a user with email and password. Returns access token and sets refresh token in httpOnly cookie.","operationId":"AuthController_login","parameters":[],"requestBody":{"required":true,"description":"User login credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"Login successful. Access token returned, refresh token set in cookie.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}},"400":{"description":"Invalid credentials or validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidationErrorResponseDto"}}}},"401":{"description":"Invalid email or password","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnauthorizedResponseDto"}}}}},"summary":"User Login","tags":["Auth"]}},"/auth/signup":{"post":{"description":"Register a new user (resident) with email, name, unit number, and password.","operationId":"AuthController_signup","parameters":[],"requestBody":{"required":true,"description":"User registration information","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignupDto"}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignupResponseDto"}}}},"400":{"description":"Validation error or email already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidationErrorResponseDto"}}}}},"summary":"User Registration","tags":["Auth"]}},"/auth/refresh":{"post":{"description":"Generate a new access token using the refresh token from cookies.","operationId":"AuthController_refresh","parameters":[],"responses":{"200":{"description":"New access token generated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}},"403":{"description":"Failed to refresh session - refresh token missing or invalid"}},"security":[{"refresh_token":[]}],"summary":"Refresh Access Token","tags":["Auth"]}},"/auth/logout":{"post":{"description":"Logout the authenticated user and clear the refresh token cookie.","operationId":"AuthController_logout","parameters":[],"responses":{"200":{"description":"Logout successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutResponseDto"}}}},"401":{"description":"Unauthorized - no valid token provided","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnauthorizedResponseDto"}}}}},"security":[{"access-token":[]}],"summary":"User Logout","tags":["Auth"]}},"/users/{id}/approve":{"patch":{"description":"Approve a pending resident registration. Only STAFF and MANAGER roles can perform this action.","operationId":"UsersController_approveResident","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the resident to approve","schema":{"example":"user-id-123","type":"string"}}],"responses":{"200":{"description":"Resident approved successfully","content":{"application/json":{"schema":{"example":{"id":"user-id-123","email":"resident@example.com","name":"John Doe","status":"APPROVED","role":"RESIDENT"}}}}},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Resident not found"}},"security":[{"access-token":[]}],"summary":"Approve a Resident","tags":["Users"]}},"/users/{id}/reject":{"patch":{"description":"Reject a pending resident registration. Only STAFF and MANAGER roles can perform this action.","operationId":"UsersController_rejectResident","parameters":[{"name":"id","required":true,"in":"path","description":"The unique ID of the resident to reject","schema":{"example":"user-id-123","type":"string"}}],"responses":{"200":{"description":"Resident rejected successfully","content":{"application/json":{"schema":{"example":{"id":"user-id-123","email":"resident@example.com","name":"John Doe","status":"REJECTED","role":"RESIDENT","rejectedAt":"2026-01-15T10:30:00Z"}}}}},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Resident not found"}},"security":[{"access-token":[]}],"summary":"Reject a Resident","tags":["Users"]}},"/users/residents":{"get":{"description":"Retrieve a list of residents with optional filtering by approval status. Only STAFF and MANAGER roles can access this.","operationId":"UsersController_getResidents","parameters":[{"name":"cursor","required":false,"in":"query","description":"Cursor for pagination - retrieve records after this cursor","schema":{"example":"cursor_string_here","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Number of records to retrieve per page","schema":{"default":10,"example":10,"type":"number"}},{"name":"pending","required":false,"in":"query","description":"Filter residents by approval status - true for pending residents, false for approved residents","schema":{"example":true,"type":"boolean"}},{"description":"Cursor for pagination - retrieve records after this cursor","required":false,"name":"cursor","in":"query","schema":{"example":"cursor_string_here","type":"string"}},{"description":"Number of records to retrieve per page","required":false,"name":"limit","in":"query","schema":{"default":10,"example":10,"type":"number"}},{"description":"Filter residents by approval status - true for pending residents, false for approved residents","required":false,"name":"pending","in":"query","schema":{"example":true,"type":"boolean"}}],"responses":{"200":{"description":"List of residents retrieved successfully","content":{"application/json":{"schema":{"example":{"data":[{"id":"user-id-1","email":"resident1@example.com","name":"John Doe","unitNumber":"A-101","status":"APPROVED","role":"RESIDENT"},{"id":"user-id-2","email":"resident2@example.com","name":"Jane Smith","unitNumber":"A-102","status":"PENDING","role":"RESIDENT"}],"meta":{"total":25,"limit":10,"cursor":"next_cursor_string"}}}}}},"403":{"description":"Forbidden - insufficient permissions"}},"security":[{"access-token":[]}],"summary":"Get Residents List","tags":["Users"]}},"/users/staffs":{"get":{"description":"Retrieve a list of staff members. Only MANAGER role can access this.","operationId":"UsersController_getStaffs","parameters":[{"name":"cursor","required":false,"in":"query","description":"Cursor for pagination - retrieve records after this cursor","schema":{"example":"cursor_string_here","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Number of records to retrieve per page","schema":{"default":10,"example":10,"type":"number"}},{"description":"Cursor for pagination - retrieve records after this cursor","required":false,"name":"cursor","in":"query","schema":{"example":"cursor_string_here","type":"string"}},{"description":"Number of records to retrieve per page","required":false,"name":"limit","in":"query","schema":{"default":10,"example":10,"type":"number"}}],"responses":{"200":{"description":"List of staff members retrieved successfully","content":{"application/json":{"schema":{"example":{"data":[{"id":"staff-id-1","email":"staff1@example.com","name":"Admin User","role":"STAFF","status":"APPROVED"},{"id":"staff-id-2","email":"staff2@example.com","name":"Manager User","role":"MANAGER","status":"APPROVED"}],"meta":{"total":5,"limit":10,"cursor":"next_cursor_string"}}}}}},"403":{"description":"Forbidden - only MANAGER role can access"}},"security":[{"access-token":[]}],"summary":"Get Staff List","tags":["Users"]}},"/notifications/test-pickup-reminders":{"post":{"operationId":"NotificationsController_testPickupReminders","parameters":[],"responses":{"201":{"description":""}},"tags":["Notifications"]}}},"info":{"title":"Parcel Pilot API","description":"API documentation for Parcel Pilot - A parcel management system","version":"1.0.0","contact":{}},"tags":[{"name":"Auth","description":"Authentication endpoints for login, signup, and token management"},{"name":"Users","description":"User management endpoints for residents and staff"},{"name":"Parcels","description":"Parcel management endpoints for creating, updating, and tracking parcels"}],"servers":[],"components":{"securitySchemes":{"access-token":{"scheme":"bearer","bearerFormat":"JWT","type":"http","description":"Enter JWT token"},"cookie":{"type":"apiKey","in":"cookie","name":"refresh_token","description":"Refresh token stored in HTTP-only cookie"}},"schemas":{"CreateParcelDto":{"type":"object","properties":{"recipientId":{"type":"string","description":"ID of the recipient (resident) who will receive the parcel","example":"resident-id-123"},"orderId":{"type":"string","description":"Order ID from courier or e-commerce platform","example":"ORD-2026-001"},"description":{"type":"string","description":"Description of the parcel contents","example":"Electronics - Headphones"},"note":{"type":"string","description":"Additional notes about the parcel","example":"Handle with care - fragile items"},"imageUrl":{"type":"string","description":"URL of the parcel image","example":"https://example.com/parcel-image.jpg"},"imageKey":{"type":"string","description":"Storage key for the parcel image in cloud storage","example":"parcels/image-key-123"},"imageSize":{"type":"number","description":"Size of the parcel image in bytes","example":102400},"courier":{"type":"string","description":"Name of the courier service","example":"DHL"}},"required":["recipientId","courier"]},"UpdateParcelDto":{"type":"object","properties":{}},"LoginDto":{"type":"object","properties":{"email":{"type":"string","description":"User email address","example":"user@example.com"},"password":{"type":"string","description":"User password (minimum 6 characters, maximum 30 characters)","example":"Password@123","minLength":6,"maxLength":30}},"required":["email","password"]},"UserResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"User ID","example":"user-id-123"},"email":{"type":"string","description":"User email address","example":"user@example.com"},"name":{"type":"string","description":"User full name","example":"John Doe"},"unitNumber":{"type":"string","description":"Unit/Apartment number for residents","example":"A-101","nullable":true},"role":{"type":"string","description":"User role - RESIDENT, STAFF, or MANAGER","enum":["RESIDENT","STAFF","MANAGER"],"example":"RESIDENT"},"status":{"type":"string","description":"User approval status - PENDING, APPROVED, or REJECTED","enum":["PENDING","APPROVED","REJECTED"],"example":"APPROVED"}},"required":["id","email","name","unitNumber","role","status"]},"LoginResponseDto":{"type":"object","properties":{"access_token":{"type":"string","description":"JWT access token for authentication","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"token_type":{"type":"string","description":"Token type","example":"Bearer"},"user":{"description":"Authenticated user information","allOf":[{"$ref":"#/components/schemas/UserResponseDto"}]}},"required":["access_token","token_type","user"]},"ValidationErrorResponseDto":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP status code","example":400},"message":{"type":"object","description":"Field validation errors","example":{"email":["email must be an email"],"password":["password must be longer than or equal to 6 characters"]},"additionalProperties":true},"timestamp":{"type":"string","description":"Error timestamp","example":"2026-01-15T10:30:00.000Z"},"path":{"type":"string","description":"Request path","example":"/api/auth/login"}},"required":["statusCode","message","timestamp","path"]},"UnauthorizedResponseDto":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP status code","example":401},"message":{"type":"string","description":"Unauthorized error message","example":"Unauthorized"},"timestamp":{"type":"string","description":"Error timestamp","example":"2026-01-15T10:30:00.000Z"},"path":{"type":"string","description":"Request path","example":"/api/parcels"}},"required":["statusCode","message","timestamp","path"]},"SignupDto":{"type":"object","properties":{"email":{"type":"string","description":"User email address","example":"user@example.com"},"name":{"type":"string","description":"User full name","example":"John Doe"},"unitNumber":{"type":"string","description":"Unit/Apartment number of the resident","example":"A-101"},"phone":{"type":"string","description":"User contact phone number (optional)","example":"+1234567890"},"password":{"type":"string","description":"User password (minimum 6 characters, maximum 30 characters)","example":"Password@123","minLength":6,"maxLength":30}},"required":["email","name","unitNumber","password"]},"SignupResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"New user ID","example":"user-id-new"},"email":{"type":"string","description":"User email","example":"newuser@example.com"},"name":{"type":"string","description":"User name","example":"Jane Smith"},"unitNumber":{"type":"string","description":"Unit number","example":"B-205"},"role":{"type":"string","description":"User role","enum":["RESIDENT","STAFF","MANAGER"],"example":"RESIDENT"},"status":{"type":"string","description":"Initial status (usually PENDING for new registrations)","enum":["PENDING","APPROVED","REJECTED"],"example":"PENDING"},"createdAt":{"type":"string","description":"Account creation timestamp","example":"2026-01-15T10:30:00Z"}},"required":["id","email","name","unitNumber","role","status","createdAt"]},"LogoutResponseDto":{"type":"object","properties":{"success":{"type":"boolean","description":"Logout success indicator","example":true},"message":{"type":"string","description":"Logout message","example":"Logged out successfully"}},"required":["success","message"]}}}}